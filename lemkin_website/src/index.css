@tailwind base;
@tailwind components;
@tailwind utilities;

/* Desktop-only Design System (Palantir/OpenAI inspired) */
@layer base {
  :root {
    /* Surfaces */
    --bg: #FFFFFF;   /* page */
    --surface: #F7F8FA;   /* section */
    --elevated: #F1F3F7;   /* cards/panels */

    /* Text */
    --ink: #0E1116;   /* primary */
    --muted: #3F4752;   /* body on surface */
    --subtle: #6B7280;   /* captions */

    /* Accent - More Institutional */
    --accent: #2952CC;   /* Deeper blue, less saturated */
    --accent-ink: #0B3C9C;

    /* Lines */
    --line: #D9DFEA;   /* hard rule */
    --line-soft: #E8EDF5;   /* inner separators */

    /* States - More Subdued */
    --success: #0F7938;   /* More subdued green */
    --warning: #B45309;   /* Earthier warning tone */
    --danger: #DC2626;
    --info: #0EA5E9;

    /* Metallic Accents */
    --metal-light: #F4F4F5;
    --metal-dark: #18181B;

    /* Focus & Shadows */
    --focus: 0 0 0 4px rgba(37, 99, 235, .20);
    --shadow-sm: 0 1px 2px rgba(14,17,22,.06);
    --shadow-md: 0 2px 8px rgba(14,17,22,.10);
    --shadow-lg: 0 8px 24px rgba(14,17,22,.12);

    /* Canonical palette mappings */
    --fg: var(--ink);
    --fg-muted: var(--muted);
    --fg-subtle: var(--subtle);
    --bd: var(--line);
    --bd-soft: var(--line-soft);
    --surface-0: var(--bg);
    --surface-1: var(--surface);
    --surface-2: var(--elevated);

    /* Legacy aliases for existing code compatibility */
    --color-text-primary: var(--ink);
    --color-text-secondary: var(--muted);
    --color-text-tertiary: var(--subtle);
    --color-bg-primary: var(--bg);
    --color-bg-secondary: var(--surface);
    --color-bg-elevated: var(--elevated);
    --color-border-primary: var(--line);
    --color-border-secondary: var(--line-soft);
    --color-primary: var(--accent);
    --color-success: var(--success);
    --color-warning: var(--warning);
    --color-critical: var(--danger);
    --color-info: var(--info);
    --shadow-elevation-1: var(--shadow-sm);
    --shadow-elevation-2: var(--shadow-md);
    --shadow-elevation-3: var(--shadow-lg);
  }

  .dark {
    --bg: #0B0F14;
    --surface: #10151B;
    --elevated: #121923;

    --ink: #E6EAF0;
    --muted: #B8C1CC;
    --subtle: #8C96A3;

    --accent: #5DA1FF;   /* tuned for dark */
    --accent-ink: #CFE2FF;

    --line: #243041;
    --line-soft: #1A2432;

    --focus: 0 0 0 4px rgba(93,161,255,.28);
    --shadow-sm: 0 1px 2px rgba(0,0,0,.35);
    --shadow-md: 0 2px 8px rgba(0,0,0,.45);
    --shadow-lg: 0 8px 24px rgba(0,0,0,.55);

    /* Canonical palette mappings */
    --fg: var(--ink);
    --fg-muted: var(--muted);
    --fg-subtle: var(--subtle);
    --bd: var(--line);
    --bd-soft: var(--line-soft);
    --surface-0: var(--bg);
    --surface-1: var(--surface);
    --surface-2: var(--elevated);

    /* Legacy aliases for existing code compatibility */
    --color-text-primary: var(--ink);
    --color-text-secondary: var(--muted);
    --color-text-tertiary: var(--subtle);
    --color-bg-primary: var(--bg);
    --color-bg-secondary: var(--surface);
    --color-bg-elevated: var(--elevated);
    --color-border-primary: var(--line);
    --color-border-secondary: var(--line-soft);
    --color-primary: var(--accent);
    --shadow-elevation-1: var(--shadow-sm);
    --shadow-elevation-2: var(--shadow-md);
    --shadow-elevation-3: var(--shadow-lg);
  }

  /* Scoped border defaults to avoid affecting SVGs and third-party widgets */
  :where(div, section, article, header, footer, main, aside, nav, form, fieldset, table, th, td, input, textarea, button, select):not(svg *) {
    border-color: var(--color-border-primary);
  }

  html, body {
    height: 100%;
  }

  body {
    color: var(--ink);
    background: var(--bg);
    font: 400 16px/1.5 system-ui, -apple-system, 'Segoe UI', Roboto, Inter, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
    font-feature-settings: "rlig" 1, "calt" 1, "ss01" 1, "ss02" 1;
  }

  * {
    box-sizing: border-box;
  }

  ::selection {
    background: rgba(37,99,235,.18);
  }

  hr, .divider {
    border-top: 1px solid var(--line);
  }

  .card {
    background: var(--surface);
    border: 1px solid var(--line);
    box-shadow: var(--shadow-sm);
    border-radius: 16px;
  }
}

/* Desktop Typography Scale - Professional & Refined */
@layer base {
  /* Typography scale: 12, 14, 16, 18, 20, 24, 32, 42 */
  h1 {
    font-size: 42px;  /* Down from 48px */
    line-height: 1.1;  /* Tighter */
    font-weight: 600;  /* Lighter weight for elegance */
    letter-spacing: -0.03em;  /* Tighter tracking */
    font-feature-settings: "ss01" 1, "ss02" 1, "kern" 1;
  }

  h2 {
    font-size: 32px;
    line-height: 1.25;
    font-weight: 600;
    letter-spacing: -0.02em;
    font-feature-settings: "ss01" 1, "ss02" 1, "kern" 1;
  }

  h3 {
    font-size: 24px;
    line-height: 1.3;
    font-weight: 600;
    letter-spacing: -0.01em;
  }

  /* Add monospace accents for data */
  .metric-value {
    font-family: 'SF Mono', 'Monaco', 'Inconsolata', monospace;
    font-variant-numeric: tabular-nums;
    letter-spacing: -0.02em;
  }

  h4 {
    font-size: 20px;
    line-height: 1.3;
    font-weight: 600;
  }

  h5, h6 {
    font-size: 18px;
    line-height: 1.3;
    font-weight: 600;
  }

  body {
    font-size: 16px;
    line-height: 24px;
    color: var(--muted); /* Body text on surfaces */
  }

  .text-caption {
    font-size: 14px;
    line-height: 20px;
    color: var(--subtle);
  }

  .text-hero {
    max-width: 22ch;
  }

  .text-body-max {
    max-width: 72ch;
  }
}

/* Desktop Component Styles */
@layer components {
  /* Button sizing scale */
  .btn {
    --btn-h: 40px;
    --btn-r: 12px;
    height: var(--btn-h);
    border-radius: var(--btn-r);
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 0 16px;
    transition: all 0.2s ease;
  }

  .btn--lg {
    --btn-h: 48px;
    --btn-r: 14px;
  }

  .btn-primary {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 0 16px;
    height: var(--btn-h, 40px);
    border-radius: var(--btn-r, 12px);
    background: var(--accent);
    color: #fff;
    border: 1px solid transparent;
    box-shadow: var(--shadow-sm);
    transition: all 0.2s ease;
  }

  .btn-primary:hover {
    filter: brightness(.98);
    transform: scale(0.99);
  }

  .btn-primary:active {
    transform: scale(0.98);
  }

  .btn-primary:focus-visible {
    box-shadow: var(--focus);
    outline: none;
  }

  .btn-outline {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 10px 16px;
    border-radius: 12px;
    background: var(--bg);
    color: var(--ink);
    border: 1px solid var(--line);
    transition: all 0.2s ease;
  }

  .btn-outline:hover {
    background: var(--surface);
  }

  .btn-outline:focus-visible {
    box-shadow: var(--focus);
    outline: none;
  }

  .link {
    color: var(--accent);
    text-underline-offset: 2px;
    transition: all 0.2s ease;
  }

  .link:hover {
    text-decoration: underline;
  }

  .link:focus-visible {
    box-shadow: var(--focus);
    outline: none;
  }

  .input {
    height: 40px;
    padding: 0 12px;
    border-radius: 12px;
    border: 1px solid var(--line);
    background: var(--bg);
    color: var(--ink);
    transition: all 0.2s ease;
  }

  .input:focus-visible {
    box-shadow: var(--focus);
    outline: none;
  }

  /* Shimmer animation for loading states */
  @keyframes shimmer {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
  }

  .animate-shimmer {
    animation: shimmer 2s infinite;
  }
}

/* Focus ring utilities */
@layer utilities {
  .focus-ring {
    @apply focus-visible:outline-none;
    transition: box-shadow 0.2s ease;
  }

  .focus-ring:focus-visible {
    box-shadow: var(--focus);
  }

  /* Placeholder text styling */
  ::placeholder { color: var(--color-text-tertiary); opacity: .95; }
  .dark ::placeholder { color: var(--color-text-tertiary); opacity: .8; }

  /* Fallbacks for color-mix() when not supported */
  @supports not (background: color-mix(in srgb, red, blue)) {
    .bg-primary-fallback:hover {
      background: rgba(0, 102, 255, 0.05) !important;
    }
    .bg-primary-fallback:active {
      background: rgba(0, 102, 255, 0.10) !important;
    }
    .bg-critical-fallback:hover {
      background: var(--color-critical) !important;
      filter: brightness(0.9);
    }
    .bg-critical-fallback:active {
      background: var(--color-critical) !important;
      filter: brightness(0.8);
    }
  }

  /* Information density utilities */
  .density-compact  :where(.btn,.chip,.row) { --y: 0.625rem; }
  .density-regular  :where(.btn,.chip,.row) { --y: 0.75rem;  }
  .density-comfort  :where(.btn,.chip,.row) { --y: 0.875rem; }

  .row { padding-block: var(--y); }
}

/* Tone down flashy utilities by default (kept for optional use) */
@layer utilities {
  .hover-glow, .gradient-animate, .text-gradient, .text-shimmer {
    animation: none !important;
    filter: none !important;
    background: none !important;
  }
}

/* Site container */
@layer utilities {
  .container-desktop {
    max-width: 1440px;
    padding: 0 48px;
    margin: 0 auto;
  }

  /* Performance: content-visibility for below-the-fold sections */
  .section-btf {
    content-visibility: auto;
    contain-intrinsic-size: 1000px;
  }
}

/* Professional Animations */
@layer utilities {
  /* Smooth Scroll */
  html {
    scroll-behavior: smooth;
  }

  /* Micro-interactions */
  .hover-lift {
    @apply transition-all duration-300 ease-out hover:-translate-y-1 hover:shadow-elevation-3;
  }

  .hover-glow {
    @apply transition-all duration-300 hover:shadow-glow;
  }

  .hover-scale {
    @apply transition-transform duration-200 ease-out hover:scale-[1.02] active:scale-[0.98];
  }

  .hover-brightness {
    @apply transition-all duration-200 hover:brightness-110;
  }

  /* Text Truncation */
  .line-clamp-1 {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Text Animations */
  .text-gradient {
    @apply bg-gradient-to-r from-primary-600 to-accent-purple bg-clip-text text-transparent;
  }

  .text-shimmer {
    background: linear-gradient(105deg, transparent 40%, rgba(255,255,255,0.7) 50%, transparent 60%);
    background-size: 200% 100%;
    background-position: -100% 0;
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: shimmer 2s infinite;
  }

  /* Glass Morphism */
  .glass {
    @apply bg-white/80 dark:bg-neutral-900/80 backdrop-blur-xl backdrop-saturate-150 border border-white/20 dark:border-white/10;
  }

  .glass-subtle {
    @apply bg-white/40 dark:bg-neutral-900/40 backdrop-blur-md backdrop-saturate-150 border border-white/10 dark:border-white/5;
  }

  /* Noise Texture Overlay */
  .noise-overlay {
    position: relative;
  }

  .noise-overlay::before {
    content: '';
    position: absolute;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.02'/%3E%3C/svg%3E");
    opacity: 0.03;
    pointer-events: none;
  }
}

/* Loading States */
@layer utilities {
  .skeleton {
    @apply animate-pulse bg-gradient-to-r from-neutral-200 via-neutral-300 to-neutral-200 dark:from-neutral-800 dark:via-neutral-700 dark:to-neutral-800;
    background-size: 200% 100%;
    animation: skeleton 1.5s ease-in-out infinite;
  }

  @keyframes skeleton {
    0% { background-position: -200% 0; }
    100% { background-position: 200% 0; }
  }
}

/* Custom Scrollbar */
@layer utilities {
  ::-webkit-scrollbar {
    width: 10px;
    height: 10px;
  }

  ::-webkit-scrollbar-track {
    @apply bg-neutral-100 dark:bg-neutral-900;
  }

  ::-webkit-scrollbar-thumb {
    @apply bg-neutral-400 dark:bg-neutral-600 rounded-full;
    @apply hover:bg-neutral-500 dark:hover:bg-neutral-500;
  }

  ::-webkit-scrollbar-thumb:active {
    @apply bg-neutral-600 dark:bg-neutral-400;
  }
}

/* Reduce motion support */
@media (prefers-reduced-motion: reduce) {
  * { animation-duration: .001ms !important; animation-iteration-count: 1 !important; transition-duration: .001ms !important; }
  html { scroll-behavior: auto; }
}

/* Desktop-only guardrails */
@media (max-width: 1199px) {
  body::before {
    content: "Optimized for desktop widths ≥ 1200px";
    position: fixed;
    inset: 0 auto auto 0;
    background: var(--surface);
    border: 1px solid var(--bd);
    padding: 6px 10px;
    font-size: 12px;
    z-index: 60;
  }
}

/* Skip link for accessibility */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only.focus\:not-sr-only:focus {
  position: static;
  width: auto;
  height: auto;
  padding: 8px 16px;
  margin: 0;
  overflow: visible;
  clip: auto;
  white-space: normal;
  background: var(--accent);
  color: #fff;
  border-radius: 8px;
  z-index: 100;
}


/* Advanced Gradient Animations */
@layer utilities {
  .gradient-animate {
    background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
    background-size: 400% 400%;
    animation: gradient-shift 15s ease infinite;
  }

  @keyframes gradient-shift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  .gradient-radial-animate {
    background: radial-gradient(circle at 50% 50%, rgba(59, 130, 246, 0.1), transparent 50%);
    animation: radial-pulse 4s ease-in-out infinite;
  }

  @keyframes radial-pulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.1); opacity: 0.7; }
  }
}

/* Shadow Elevation System - Simplified to 2 tiers */
@layer utilities {
  .shadow-1 { box-shadow: 0 1px 2px rgba(14,17,22,.06); }
  .shadow-2 { box-shadow: 0 8px 24px rgba(14,17,22,.12); }
  .dark .shadow-1 { box-shadow: 0 1px 2px rgba(0,0,0,.35); }
  .dark .shadow-2 { box-shadow: 0 8px 24px rgba(0,0,0,.55); }

  /* Standardized surface combinations */
  .surface-default {
    background: var(--color-bg-elevated);
    border: 1px solid var(--color-border-primary);
    box-shadow: var(--shadow-elevation-1);
  }

  .surface-card {
    background: var(--color-bg-elevated);
    border: 1px solid var(--color-border-primary);
    box-shadow: var(--shadow-elevation-1);
  }

  .surface-elevated {
    background: var(--color-bg-elevated);
    border: 1px solid var(--color-border-primary);
    box-shadow: var(--shadow-elevation-2);
  }

  .surface-modal {
    background: var(--color-bg-elevated);
    border: 1px solid var(--color-border-primary);
    box-shadow: var(--shadow-elevation-4);
  }

  .surface-menu {
    background: var(--color-bg-elevated);
    border: 1px solid var(--color-border-primary);
    box-shadow: var(--shadow-elevation-3);
  }
}

/* Sophisticated Hover Effects */
@layer components {
  .btn-primary {
    @apply relative overflow-hidden px-6 py-3 font-medium text-white bg-primary-600 rounded-xl transition-all duration-300 hover:bg-primary-700 hover:shadow-elevation-3 active:scale-[0.98];
  }

  .btn-primary::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.5);
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
  }

  .btn-primary:hover::before {
    width: 300px;
    height: 300px;
  }

  .card-hover {
    @apply relative overflow-hidden transition-all duration-500 hover:shadow-elevation-4;
  }

  .card-hover::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
    transition: left 0.5s;
  }

  .card-hover:hover::before {
    left: 100%;
  }

  /* OpenAI-style professional capability card transitions */
  .capability-cards-container {
    position: relative;
    width: 100%;
    height: auto;
  }

  .capability-cards-set {
    transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .capability-cards-set.entering {
    opacity: 0;
  }

  .capability-cards-set.entered {
    opacity: 1;
  }

  .capability-cards-set.exiting {
    opacity: 0;
  }

  /* Individual card animations with staggered entrance */
  .capability-card {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    opacity: 0;
    transform: translateY(8px);
  }

  .capability-card.visible {
    opacity: 1;
    transform: translateY(0);
  }

  .capability-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
  }

  /* Staggered entrance animation */
  .capability-card:nth-child(1) { transition-delay: 0ms; }
  .capability-card:nth-child(2) { transition-delay: 80ms; }
  .capability-card:nth-child(3) { transition-delay: 160ms; }
  .capability-card:nth-child(4) { transition-delay: 240ms; }
}